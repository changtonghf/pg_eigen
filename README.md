# pg_eigen
PostgreSQL library for linear algebra algorithms


## installation
```sh
git clone https://github.com/PX4/eigen.git
sudo cp -r eigen/Eigen /usr/local/include/
sudo cp -r eigen/unsupported /usr/local/include/
git clone https://github.com/changtonghf/pg_eigen.git
cd pg_eigen
--compile & install
make PG_CONFIG=/usr/pgsql-14/bin/pg_config
make PG_CONFIG=/usr/pgsql-14/bin/pg_config install
--uninstall & clean
make PG_CONFIG=/usr/pgsql-14/bin/pg_config uninstall
make PG_CONFIG=/usr/pgsql-14/bin/pg_config clean
```

## function list
### 1. array_reduce
```sql
select array_reduce('minimum', array[[[[1,2,3,4,5],[6,7,8,9,10],[11,12,13,14,15],[16,17,18,19,20]],[[21,22,23,24,25],[26,27,28,29,30],[31,32,33,34,35],[36,37,38,39,40]],[[41,42,43,44,45],[46,47,48,49,50],[51,52,53,54,55],[56,57,58,59,60]]],[[[61,62,63,64,65],[66,67,68,69,70],[71,72,73,74,75],[76,77,78,79,80]],[[81,82,83,84,85],[86,87,88,89,90],[91,92,93,94,95],[96,97,98,99,100]],[[101,102,103,104,105],[106,107,108,109,110],[111,112,113,114,115],[116,117,118,119,120]]]]::float4[], array[0,1,2]::int[]);
 array_reduce 
--------------
 {1,2,3,4,5}
(1 row)

select array_reduce('maximum', array[[[[1,2,3,4,5],[6,7,8,9,10],[11,12,13,14,15],[16,17,18,19,20]],[[21,22,23,24,25],[26,27,28,29,30],[31,32,33,34,35],[36,37,38,39,40]],[[41,42,43,44,45],[46,47,48,49,50],[51,52,53,54,55],[56,57,58,59,60]]],[[[61,62,63,64,65],[66,67,68,69,70],[71,72,73,74,75],[76,77,78,79,80]],[[81,82,83,84,85],[86,87,88,89,90],[91,92,93,94,95],[96,97,98,99,100]],[[101,102,103,104,105],[106,107,108,109,110],[111,112,113,114,115],[116,117,118,119,120]]]]::float4[], array[0,1,2]::int[]);
     array_reduce      
-----------------------
 {116,117,118,119,120}
(1 row)

select array_reduce('sum', array[[[[1,2,3,4,5],[6,7,8,9,10],[11,12,13,14,15],[16,17,18,19,20]],[[21,22,23,24,25],[26,27,28,29,30],[31,32,33,34,35],[36,37,38,39,40]],[[41,42,43,44,45],[46,47,48,49,50],[51,52,53,54,55],[56,57,58,59,60]]],[[[61,62,63,64,65],[66,67,68,69,70],[71,72,73,74,75],[76,77,78,79,80]],[[81,82,83,84,85],[86,87,88,89,90],[91,92,93,94,95],[96,97,98,99,100]],[[101,102,103,104,105],[106,107,108,109,110],[111,112,113,114,115],[116,117,118,119,120]]]]::float4[], array[0,1,2]::int[]);
        array_reduce        
----------------------------
 {1404,1428,1452,1476,1500}
(1 row)

select array_reduce('mean', array[[[[1,2,3,4,5],[6,7,8,9,10],[11,12,13,14,15],[16,17,18,19,20]],[[21,22,23,24,25],[26,27,28,29,30],[31,32,33,34,35],[36,37,38,39,40]],[[41,42,43,44,45],[46,47,48,49,50],[51,52,53,54,55],[56,57,58,59,60]]],[[[61,62,63,64,65],[66,67,68,69,70],[71,72,73,74,75],[76,77,78,79,80]],[[81,82,83,84,85],[86,87,88,89,90],[91,92,93,94,95],[96,97,98,99,100]],[[101,102,103,104,105],[106,107,108,109,110],[111,112,113,114,115],[116,117,118,119,120]]]]::float4[], array[0,1,2]::int[]);
        array_reduce        
----------------------------
 {58.5,59.5,60.5,61.5,62.5}
(1 row)

select array_reduce('prod', array[[[[1,2,3,4,5],[6,7,8,9,10],[11,12,13,14,15],[16,17,18,19,20]],[[21,22,23,24,25],[26,27,28,29,30],[31,32,33,34,35],[36,37,38,39,40]],[[41,42,43,44,45],[46,47,48,49,50],[51,52,53,54,55],[56,57,58,59,60]]],[[[61,62,63,64,65],[66,67,68,69,70],[71,72,73,74,75],[76,77,78,79,80]],[[81,82,83,84,85],[86,87,88,89,90],[91,92,93,94,95],[96,97,98,99,100]],[[101,102,103,104,105],[106,107,108,109,110],[111,112,113,114,115],[116,117,118,119,120]]]]::float4[], array[0,1,2]::int[]);
                  array_reduce                  
------------------------------------------------
 {Infinity,Infinity,Infinity,Infinity,Infinity}
(1 row)

```
### 1. array_fft
```sql
/*
 * The first parameter represents the direction of the Fourier transform, where true indicates the forward transform and false indicates the inverse transform. 
 * The second parameter is the sampled signal data to be processed. 
 * The third parameter represents the axis along which the computation should be performed.
 */
--real case 2D
select array_fft(true, array[[1,2,3],[4,5,6]]::float[],array[0,1]);
                                                                                                                   array_fft
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {{{21,-8.881784197001252e-16},{-2.999999999999999,1.7320508075688812},{-3.0000000000000044,-1.7320508075688679}},{{-9,7.954818481105242e-17},{-5.828313194834535e-16,-5.928928440470584e-16},{2.572730330570817e-16,-2.1590185687695387e-15}}}
(1 row)

--real case 3D
select array_fft(true, array[[[1,2,3,4],[5,6,7,8],[9,10,11,12],[13,14,15,16]],[[17,18,19,20],[21,22,23,24],[25,26,27,28],[29,30,31,32]],[[33,34,35,36],[37,38,39,40],[41,42,43,44],[45,46,47,48]],[[49,50,51,52],[53,54,55,56],[57,58,59,60],[61,62,63,64]]]::float[],array[0,1,2]);
                                                                                                                                                                                                                                     array_fft
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {{{{2080,0},{-32,32},{-32,0},{-32,-32}},{{-128,128},{0,0},{0,0},{0,0}},{{-128,0},{0,0},{0,0},{0,0}},{{-128,-128},{0,0},{0,0},{0,0}}},{{{-512,512},{0,0},{0,0},{0,0}},{{0,0},{0,0},{0,0},{0,0}},{{0,0},{0,0},{0,0},{0,0}},{{0,0},{0,0},{0,0},{0,0}}},{{{-512,0},{0,0},{0,0},{0,0}},{{0,0},{0,0},{0,0},{0,0}},{{0,0},{0,0},{0,0},{0,0}},{{0,0},{0,0},{0,0},{0,0}}},{{{-512,-512},{0,0},{0,0},{0,0}},{{0,0},{0,0},{0,0},{0,0}},{{0,0},{0,0},{0,0},{0,0}},{{0,0},{0,0},{0,0},{0,0}}}}
(1 row)

--complex case 3D
select array_fft(true, array[[[[1,0],[2,0],[3,0],[4,0]],[[5,0],[6,0],[7,0],[8,0]],[[9,0],[10,0],[11,0],[12,0]]],[[[13,0],[14,0],[15,0],[16,0]],[[17,0],[18,0],[19,0],[20,0]],[[21,0],[22,0],[23,0],[24,0]]]]::float[],array[0,1,2]);
                                                                        array_fft
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 {{{{300,-9.769962616701378e-15},{-11.999999999999998,12},{-12,8.881784197001252e-16},{-12.000000000000002,-12}},{{-47.99999999999997,27.712812921102085},{-7.993605777301127e-15,-1.0658141036401503e-14},{3.552713678800501e-15,-7.105427357601002e-15},{8.881784197001252e-16,3.552713678800501e-15}},{{-48.00000000000007,-27.712812921101907},{-3.552713678800501e-15,0},{3.552713678800501e-15,-7.105427357601002e-15},{1.0658141036401503e-14,3.552713678800501e-15}}},{{{-144,1.2727709569768387e-15},{0,0},{0,0},{0,0}},{{-9.325301111735256e-15,-9.486285504752935e-15},{0,0},{0,0},{0,0}},{{4.1163685289133076e-15,-3.454429710031262e-14},{0,0},{0,0},{0,0}}}}
(1 row)
```
